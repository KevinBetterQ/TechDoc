# 微服务中 RPC 和 RESTFUL 之间的区别

这篇文章大概是没有什么结构的，基本上是想到什么写什么。不管对不对先把思考的东西写下来再说。

之所以思考微服务的问题，是一直想搞清楚Restful的接口规范和RPC的接口规范到底有什么不同，以及它们彼此适用的场景。

事实上在最近的一个系统中，我一直使用的是Restful的接口，因为这个系统是前后端分离的模式，前端用React，而后端用的是Go。而这个系统的服务对象是产品团队，他们的服务都是基于SpringCloud的微服务框架。

为了能够让大家能够更加轻松地使用Spring框架来开发应用，SpringBoot出现了，而为了能够让Spring更好地支持微服务SpringCloud出现了。所以SpringBoot是传统的单体应用解决方案，而SpringCloud是微服务架构的解决方案。

总之为了简单，下面都叫做Spring服务。

理论上Spring服务之间的调用采用Restful和RPC都可以。Restful和RPC规范的技术风格这个网上都有，但是技术选型的基本策略倒是没看到多少，这个就是为什么我要自己想一想写一写的原因，或许哪里也有但是我没看到，反正就这样了。

Chris大佬说不存在所谓的“微服务”，而是微服务架构。而且这个微服务和服务的大小没关系，而是基于服务功能性把不同的功能内聚为一个服务，从原有的单体应用中剥离。

剥离之后的各个服务拥有自己独立的数据库，独立的业务逻辑，和其他的业务系统之间使用接口互相调用。那么问题来了，到底使用Restful还是RPC接口呢？我们这里说的RPC接口主要是指基于Protobuff这类调用的RPC。因为如果单从字面意思去理解Restful本身也是RPC接口。

经过一段时间的思考，我个人认为在内部进行通信的系统采用基于Protobuff这类型的RPC方案会比较好。而如果一个服务需要对外提供接口，比如是一个直接面向移动APP或者是Web前端的服务，采用Restful会比较好。

这种思考的结果基于的最基本的原则就是协同开发的效率。

协同开发的效率主要取决于两点，第一个是参与协同的服务角色，另外一个则是企业发展过程中沉淀的基础设施。

比如服务 A 和服务 B 都是使用 SpringBoot 或者 Golang 开发的后端服务，彼此通信最佳方式是使用 RPC。采取这个方式要基于一个事实就是服务 A 和服务 B 之间存在着大量的通信。在存在大量通信的服务之间，如果采用Restful的接口，那么还需要去定义接口的表现层，然后描述具体的参数和响应。这个在存在大量接口交互的情况下，是一个庞大的工作量，另外接口的变动更新也变得复杂。在微服务框架下，出于高可用的情况，服务的实例一般会有多个，这种带来了服务发现和转发的问题。在基于RPC的调用中，我们可以使用 API 网关完成这个工作。而在 Restful 的接口中，更多的要依赖运维层面的控制。

当然如果这个时候出现了服务 M 和 W ，分别代表了移动端和Web端。那么这个时候如果要和一个后端的服务 S 通信，那么最佳的方案是使用 Restful 风格的接口。因为在面向用户交互的过程中，更多的是定义和维护系统中的实体对象，简单来说就是面向对象的CRUD，这个使用Restful接口最方便了，而且这种CRUD的接口很少发生变动，即使变动维护成本也很低。

另外一般在企业当中，前端应用包括移动端和Web端都有了比较成熟的基础设施，一般就是基于流行开源框架基础之上进一步封装的集成了各个企业内部的一些基础服务比如统一登陆形成了框架。这些框架优先也会选择使用 Restful 的接口去和后端进行交互。这种情况下，接口文档是必不可少的。而RPC的模式下，写好框架里面语言层面的 interface 的注释基本上就好了。

总之呢，上面的描述适用于一些比较大型的系统交互。当然了Chris大佬说过，如果不是大型的系统，搞什么微服务架构，单体应用用用好嘞。

当然了，基于RPC的调用在网络协议方面可以采用HTTP或者是TCP，而Restful一般就只能用HTTP了。在大量接口交互下，RPC还有性能提升的空间。

就写那么多吧，再想想如果不对，重写。

EOF

